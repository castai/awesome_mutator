apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: {{ include "awesome-mutator.fullname" . }}
webhooks:
  - name: awesome-mutator.cast.ai
    clientConfig:
      service:
        name: {{ include "awesome-mutator.fullname" . }}
        namespace: {{ .Release.Namespace }}
        path: /mutate
      caBundle: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQ1ekNDQXMrZ0F3SUJBZ0lVVGNtM21VZDlaOVBTdVFQRFA1VTRST3c3RVFJd0RRWUpLb1pJaHZjTkFRRUwKQlFBd2JERUxNQWtHQTFVRUJoTUNWVk14RURBT0JnTlZCQWdNQjBac2IzSmthV0V4RGpBTUJnTlZCQWNNQlUxcApZVzFwTVJBd0RnWURWUVFLREFkRFFWTlVJRUZKTVNrd0p3WURWUVFERENCaGQyVnpiMjFsTFcxMWRHRjBiM0l1ClkyRnpkR0ZwTFdGblpXNTBMbk4yWXpBZUZ3MHlOREE1TURReE1qUXhNVGxhRncweU56QTJNalV4TWpReE1UbGEKTUd3eEN6QUpCZ05WQkFZVEFsVlRNUkF3RGdZRFZRUUlEQWRHYkc5eVpHbGhNUTR3REFZRFZRUUhEQVZOYVdGdAphVEVRTUE0R0ExVUVDZ3dIUTBGVFZDQkJTVEVwTUNjR0ExVUVBd3dnWVhkbGMyOXRaUzF0ZFhSaGRHOXlMbU5oCmMzUmhhUzFoWjJWdWRDNXpkbU13Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRREcKbzJPNVVrSndTdzFGaW9tUS9OK01qa04rbkEyS3VWdmZjVmxtMDhNcllNY2h1WVJaRyt1R0JIMDZPcFI3aE01cQpFQkE1bFBTOVZ5cmVVb01vcDBvM0hWckd0QnMrN0t0bE5oNUY0a2NJS3ZDOUYzd2xEc2k1R3NOY1BPdm9lZjA2CkZmd3JuVEwyQXRBWEZEYld4SUR4RnFSTTgyL3JWQ3cxUmlZZVVmdHBCNjJzL0lUdldZZTJrTUV5TS9HOE5nbDkKV3l4WWZPc3NqZEptWmNFNGQ2MHM0bWJIaTIrZWplQTMyRWhZOWwyMC94R2daUmpoNjMvUGkyNEpyVE5GQUJvbgo0VUtsMU1SUjBZTUlQT2JsckR1cE5IcSt2NHZHMzVwTGZhR25GekZ1L2xyaGJ5Mnc5ODBnVDRONE1xZ3hkN1N0CjBUdFJCaUFOMHZXNkJwcWk1SzNSQWdNQkFBR2pnWUF3ZmpBZEJnTlZIUTRFRmdRVWdwdTcwNGlsbS9Da0R6UmcKWjZmem84eHVJWDB3SHdZRFZSMGpCQmd3Rm9BVWdwdTcwNGlsbS9Da0R6UmdaNmZ6bzh4dUlYMHdEd1lEVlIwVApBUUgvQkFVd0F3RUIvekFyQmdOVkhSRUVKREFpZ2lCaGQyVnpiMjFsTFcxMWRHRjBiM0l1WTJGemRHRnBMV0ZuClpXNTBMbk4yWXpBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQVM1UW90TkJWZ2JIb3V4Vnc0ZkJ2VE5aTTV0NjIKTU44YjhIUWVvR1VhUE1HNkZjOVpZd0g5UmovblJLSnhMeEpnU0JjUGE3K1d0dkdOV0dxZGZWeVRUTlZGSElnMAphY0s3NWtob1liRWkzRDZvMFk2czZDV1QrTXFNbEhnMkdyWDFJV0x4UHhJVUVxc2c1UHJDVG95cXc4Z2NISFdlCm96VlNmZGJxUWFFM3BBcE5PV280dk9NSURJaXJJRmJWS2RMTm9GNi9JRTJMQ0dsVGhIVy8raVcvU3pQSlY3dkkKZnNpWVJPNUVLMlU1c3FoTFNUODRlbzhCbUJpbTcvR2gxT1JhblprZlZyOXYycVowRkdQVzgwMG9PRlM0NEQ1cwplRk1lR0pGT3ZlZDhsWFJrV0ovTXhnUCszRm9EVW9KYVU1Ykk0Rm5EUVV1VEc1U09lbEZsR2lqNjZnPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo="
    rules:
      - operations: ["CREATE"]
        apiGroups: [""]
        apiVersions: ["v1"]
        resources: ["pods"]
    admissionReviewVersions: ["v1"]
    failurePolicy: {{ .Values.failurePolicy }}  # Fail
    sideEffects: None